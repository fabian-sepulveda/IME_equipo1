source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
modelo <- glm(EN ~ Chest.diameter, family = binomial(link = "logit"), data = muestra.entrenamiento)
print(summary(modelo))
probs_e <- predict(modelo, muestra.entrenamiento, type = "response")
print(probs_e)
#Evaluación modelo entrenamiento
prob_e <- predict(modelo, muestra.entrenamiento, type = "response")
umbral <- 0.5
preds_e <- sapply(prob_e, function(p) ifelse(p >= umbral, "1", "0"))
preds_e <- factor(preds_e, levels = levels(datos[["EN"]]))
ROC_e <- roc(muestra.entrenamiento[["EN"]], prob_e)
plot(ROC_e)
#Evaluación modelo entrenamiento
prob_e <- predict(modelo, muestra.entrenamiento, type = "response")
umbral <- 0.5
preds_e <- sapply(prob_e, function(p) ifelse(p >= umbral, "1", "0"))
preds_e <- factor(preds_e, levels = levels(datos[["EN"]]))
ROC_e <- roc(muestra.entrenamiento[["EN"]], prob_e)
plot(ROC_e)
ROC_e <- roc(muestra.entrenamiento[["EN"]], prob_e)
#Evaluación modelo entrenamiento
prob_e <- predict(modelo, muestra.entrenamiento, type = "response")
umbral <- 0.5
preds_e <- sapply(prob_e, function(p) ifelse(p >= umbral, "1", "0"))
preds_e <- factor(preds_e, levels = levels(datos[["EN"]]))
ROC_e <- roc(muestra.entrenamiento[["EN"]], prob_e)
plot(ROC_e)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
View(ROC_e)
print(summary(modelo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
prueba1 <- durbinWatsonTest(nuevo.modelo)
print(prueba1)
print(durbinWatsonTest(nuevo.modelo, max.lag = 5))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
print(durbinWatsonTest(modelo_RLM) )
print(durbinWatsonTest(modelo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo_RLM))
print(durbinWatsonTest(modelo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo))
modelo <- glm(EN ~ Chest.diameter, family = binomial(link = "logit"), data = muestra.entrenamiento)
print(summary(modelo))
modelo <- glm(EN ~ Chest.diameter, family = binomial(link = "logit"), data = muestra.entrenamiento)
print(summary(modelo))
print(durbinWatsonTest(modelo))
modelo <- glm(EN ~ Knee.Girth, family = binomial(link = "logit"), data = muestra.entrenamiento)
print(summary(modelo))
print(durbinWatsonTest(modelo))
modelo <- glm(EN ~ Biiliac.diameter, family = binomial(link = "logit"), data = muestra.entrenamiento)
print(summary(modelo))
print(durbinWatsonTest(modelo))
modelo <- glm(EN ~ Biiliac.diameter, family = binomial(link = "logit"), data = muestra.entrenamiento)
print(summary(modelo))
print(durbinWatsonTest(modelo))
View(muestra.entrenamiento)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
View(entrenamiento)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo))
View(datos)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
View(datos)
View(entrenamiento)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
View(entrenamiento)
View(entrenamiento)
View(muestra.entrenamiento)
View(muestra.entrenamiento)
print(durbinWatsonTest(modelo_RLM) )
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
print(durbinWatsonTest(modelo_RLM) )
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
print(durbinWatsonTest(modelo_RLM) )
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo.completo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(drop1(modelo.completo, scope = modelo.completo))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(nuevo.modelo) )
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/jenni.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
#Evaluar poder predictivo
prob_p <- predict(modelo, muestra.prueba, type = "response")
preds_p <- sapply(prob_e, function(p) ifelse(p >= umbral, "1", "0"))
preds_p <- factor(preds_e, levels = levels(datos[["EN"]]))
ROC_p <- roc(muestra.prueba[["EN"]], prob_p)
plot(ROC_p)
matriz_e <- confusionMatrix(preds_e , entrenamiento [["EN"]])
print(matriz_e)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(rownames(muestra.entrenamiento[sospechosos4 , ]))
prob_p <- predict(nuevo.modelo, muestra.prueba, type = "response")
preds_p <- sapply(prob_e, function(p) ifelse(p >= umbral, "1", "0"))
preds_p <- factor(preds_e, levels = levels(datos[["EN"]]))
ROC_p <- roc(muestra.prueba[["EN"]], prob_p)
plot(ROC_p)
matriz_e <- confusionMatrix(preds_e , muestra.entrenamiento [["EN"]])
print(matriz_e)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
#Evaluar poder predictivo
prob_p <- predict(nuevo.modelo, muestra.entrenamiento, type = "response")
preds_p <- sapply(prob_e, function(p) ifelse(p >= umbral, "1", "0"))
preds_p <- factor(preds_e, levels = levels(datos[["EN"]]))
ROC_p <- roc(muestra.prueba[["EN"]], prob_p)
plot(ROC_p)
matriz_e <- confusionMatrix(preds_e , muestra.entrenamiento [["EN"]])
print(matriz_e)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
prob_n <- predict(nuevo.modelo, muestra.entrenamiento, type = "response")
preds_n <- sapply(prob_n, function(p) ifelse(p >= umbral, "1", "0"))
preds_n <- factor(preds_n, levels = levels(datos[["EN"]]))
ROC_n <- roc(muestra.prueba[["EN"]], prob_n)
plot(ROC_n)
matriz_n <- confusionMatrix(preds_n , muestra.entrenamiento [["EN"]])
print(matriz_n)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
#Evaluar poder predictivo
prob_n <- predict(nuevo.modelo, muestra.entrenamiento, type = "response")
preds_n <- sapply(prob_n, function(p) ifelse(p >= umbral, "1", "0"))
preds_n <- factor(preds_n, levels = levels(datos[["EN"]]))
ROC_n <- roc(muestra.entrenamiento[["EN"]], prob_n)
plot(ROC_n)
matriz_n <- confusionMatrix(preds_n , muestra.entrenamiento [["EN"]])
print(matriz_n)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
#Evaluar poder predictivo
prob_n <- predict(nuevo.modelo, muestra.entrenamiento, type = "response")
preds_n <- sapply(prob_n, function(p) ifelse(p >= umbral, "1", "0"))
preds_n <- factor(preds_n, levels = levels(datos[["EN"]]))
ROC_n <- roc(muestra.entrenamiento[["EN"]], prob_n)
plot(ROC_n)
matriz_n <- confusionMatrix(preds_n , muestra.entrenamiento [["EN"]])
print(matriz_n)
#Evaluar poder predictivo
prob_n <- predict(nuevo.modelo, muestra.entrenamiento, type = "response")
preds_n <- sapply(prob_n, function(p) ifelse(p >= umbral, "1", "0"))
preds_n <- factor(preds_n, levels = levels(datos[["EN"]]))
ROC_n <- roc(muestra.entrenamiento[["EN"]], prob_n)
plot(ROC_n)
#Evaluar poder predictivo
prob_n <- predict(nuevo.modelo, muestra.entrenamiento, type = "response")
preds_n <- sapply(prob_n, function(p) ifelse(p >= umbral, "1", "0"))
preds_n <- factor(preds_n, levels = levels(datos[["EN"]]))
ROC_n <- roc(muestra.entrenamiento[["EN"]], prob_n)
plot(ROC_n)
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
print(durbinWatsonTest(modelo) )
#Ajuste del modelo de regresión logística
modelo <- glm(EN ~ Waist.Girth, family = binomial(link = "logit"), data = muestra.prueba)
print(summary(modelo))
print(durbinWatsonTest(modelo) )
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
muestra.entrenamiento <- sample_n(muestra.entrenamiento, nrow(muestra.entrenamiento))
#Se define las muestras de entrenamiento y prueba
muestra.entrenamiento <- rbind(hombres.nosobrepeso[1:40, ],hombres.sobrepeso[1:40, ])
View(muestra.entrenamiento)
View(muestra.entrenamiento)
muestra.entrenamiento <- sample_n(muestra.entrenamiento, nrow(muestra.entrenamiento))
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
source("C:/Users/fabia/Desktop/01-2022/IME/IME_equipo1/EP14/EP14.R")
cat ("Verificación de colinealidad \n")
cat (" - - - - - - - - - - -- - - - - - - - - - - - - - - - - - - - -- - - - - -\n")
cat ("\n VIF :\n")
vifs <- vif (nuevo.modelo)
print ( vifs )
cat ("\n Promedio VIF: ")
print ( mean ( vifs ) )
cat (" Verificación de independencia de los residuos \n")
cat (" - - - - - - - - - - -- - - - - - - - - - - - - - - - - - - - -- - - - - -\n")
print(durbinWatsonTest(nuevo.modelo) )
# Comparar los modelos RLS y el RLM
cat ("\n\n")
cat (" Likelihood Ratio Test para los modelos \n")
cat (" - - - - - - - - - - -- - - - - - - - - - - - - - - - - - - - -- - - - - -\n")
print (anova(modelo, nuevo.modelo, test = "LRT") )
print(summary(nuevo.modelo))
